# Claude Code 設定

## 言語設定
- ターミナルでのやり取りは日本語で行う
- コード内の変数名や関数名は英語を使用するが、説明や文書化は日本語で行う
    - なお、テストコードの関数名は`test_日本語`の命名規則とする

## ドキュメント構成

### ドキュメント設計原則
- **DRY原則に準拠**: 定義や説明の重複を避け、1つのドキュメントに集約
- **参照関係の明確化**: 詳細説明は専用ドキュメントに記載し、他は参照のみ
- **役割分担の明確化**: 各ドキュメントの役割を明確に区分

### このファイル（CLAUDE.md）の役割
- **Claude Codeが毎回実行すべき具体的なコマンドと手順**
- **開発時に必ず守るべき基本ルールと禁止事項**
- **簡潔で実行可能な指示のみを記載**

### docs/wikiディレクトリの役割
- **詳細な技術仕様と環境セットアップ手順**
- **開発者向けの包括的な情報と背景説明**
- **長期的な技術決定の根拠と詳細**

### 詳細ドキュメント
詳細な情報は `docs/wiki` ディレクトリのwikiを参照：
- [プロジェクト概要](docs/wiki/プロジェクト概要.md) - プロジェクトの全体像と目的
- [技術スタック](docs/wiki/技術スタック.md) - 使用技術の詳細と選定理由
- [開発環境](docs/wiki/開発環境.md) - セットアップ手順と環境設定
- [開発フロー](docs/wiki/開発フロー.md) - 詳細な開発手順とレビュー観点
- [CI/CD](docs/wiki/CI-CD.md) - GitHub Actions の実装詳細

## Claude Code への指示

### 開発フロー

#### 1. ブランチ作成
```bash
# feature/機能名、bugfix/バグ修正名、refactor/リファクタ名 のいずれかで命名
git switch -c feature/new-feature
```

#### 2. 開発作業中の必須実行コマンド
開発中は定期的に品質チェックを実行してCIエラーを事前に防ぐ。

**詳細な実行手順**: [開発フロー.md](docs/wiki/開発フロー.md)を参照

#### 3. PR作成前の必須チェック
**PR作成前に必ず以下をすべて実行し、エラーがないことを確認する：**

##### 3.1 ドキュメント更新の確認
**変更内容に応じて関連ドキュメントを必ず更新する：**
- **新機能・API追加**: [開発フロー.md](docs/wiki/開発フロー.md)、[技術スタック.md](docs/wiki/技術スタック.md)
- **環境設定・コマンド変更**: [開発環境.md](docs/wiki/開発環境.md)、CLAUDE.md
- **CI/CD変更**: [CI-CD.md](docs/wiki/CI-CD.md)
- **データベース変更**: [データベース設計.md](docs/wiki/データベース設計.md)
- **プロジェクト構造変更**: [プロジェクト概要.md](docs/wiki/プロジェクト概要.md)

##### 3.2 テスト・品質チェック実行
**詳細な実行手順**: [開発フロー.md](docs/wiki/開発フロー.md)を参照

#### 4. PR作成後のCI確認
- **GitHub ActionsのCI/CDパイプラインが正常に完了することを必ず確認する**
- CI失敗時は必ず修正してから次の作業に進む
- カバレッジレポートも確認し、必要に応じてテストを追加する

#### 5. 基本開発原則
- **GitHubのissueを作成してからプルリクエストに紐づけて行う**
- **コード変更時は対応するドキュメントも必ず同時更新する**
- **ドキュメント更新なしでのPR作成は禁止**
- 詳細な開発フロー: [開発フロー.md](docs/wiki/開発フロー.md)

### 開発禁止事項
- **mainブランチにmerge済みのdatabase/migrationsファイルを後から変更してはいけない**
- 既存のmigrationファイルを変更する場合は、新しいmigrationファイルを作成する

### テスト実行
**詳細な実行手順**: [開発フロー.md](docs/wiki/開発フロー.md)を参照

### CI/CD 並列実行
- **Unit/Feature Tests**: 通常のCIワークフロー（約2分）
- **E2E Tests**: 専用CIワークフロー（Playwright コンテナ、4並列、約1分）
- **並列実行**: 両方同時実行でトータル時間短縮

### 開発コマンド詳細
詳細な開発コマンドと環境設定は下記ドキュメントを参照：
- セットアップ: [開発環境.md](docs/wiki/開発環境.md)
- テストと品質チェック: [開発フロー.md](docs/wiki/開発フロー.md)
- CI/CDワークフロー: [CI-CD.md](docs/wiki/CI-CD.md)