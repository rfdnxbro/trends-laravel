# CI/CD

## ç¾åœ¨ã®å®Ÿè£…çŠ¶æ³

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯**GitHub Actions**ã‚’ä½¿ç”¨ã—ã¦CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚’å®Œå…¨ã«æ§‹ç¯‰ãƒ»é‹ç”¨ã—ã¦ã„ã¾ã™ã€‚

## âœ… ç¾åœ¨å®Ÿè£…æ¸ˆã¿ã®æ©Ÿèƒ½

### Wikiè‡ªå‹•åŒæœŸ
- **å¯¾è±¡**: `docs/wiki` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
- **å®Ÿè¡Œã‚¿ã‚¤ãƒŸãƒ³ã‚°**: mainãƒ–ãƒ©ãƒ³ãƒã¸ã®ãƒ—ãƒƒã‚·ãƒ¥æ™‚
- **åŒæœŸå…ˆ**: GitHub Wiki
- **ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«**: `.github/workflows/sync-wiki.yml`
- **å®Ÿè£…çŠ¶æ³**: âœ… å®Œå…¨å®Ÿè£…æ¸ˆã¿

### è‡ªå‹•ãƒ†ã‚¹ãƒˆãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³
- **ãƒ†ã‚¹ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯**: PHPUnitã€vitest
- **å®Ÿè¡Œã‚¿ã‚¤ãƒŸãƒ³ã‚°**: PRä½œæˆæ™‚ã€mainãƒ–ãƒ©ãƒ³ãƒã¸ã®ãƒ—ãƒƒã‚·ãƒ¥æ™‚
- **ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«**: `.github/workflows/test.yml`
- **å®Ÿè£…çŠ¶æ³**: âœ… **å®Œå…¨å®Ÿè£…æ¸ˆã¿**
- **ãƒ†ã‚¹ãƒˆæ•°**: PHPUnit 205ãƒ†ã‚¹ãƒˆã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ 64ãƒ†ã‚¹ãƒˆ
- **ç’°å¢ƒ**: SQLite in-memoryï¼ˆé«˜é€Ÿãƒ»ä¸€è²«æ€§ä¿è¨¼ï¼‰

### ã‚³ãƒ¼ãƒ‰å“è³ªãƒã‚§ãƒƒã‚¯
- **Laravel Pint**: ã‚³ãƒ¼ãƒ‰ã‚¹ã‚¿ã‚¤ãƒ«ãƒã‚§ãƒƒã‚¯ âœ… **å®Ÿè£…æ¸ˆã¿**
- **PHPStan**: é™çš„è§£æï¼ˆãƒ¬ãƒ™ãƒ«4ã€ã‚¨ãƒ©ãƒ¼0ï¼‰ âœ… **å®Ÿè£…æ¸ˆã¿**
- **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ“ãƒ«ãƒ‰**: Viteæœ¬ç•ªãƒ“ãƒ«ãƒ‰ãƒ†ã‚¹ãƒˆ âœ… **å®Ÿè£…æ¸ˆã¿**

## ğŸ”§ å®Ÿè£…ã•ã‚ŒãŸãƒ†ã‚¹ãƒˆãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³

### ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«

**ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹:** `.github/workflows/test.yml`

```yaml
name: Test

on:
  pull_request:
    branches: [ main ]
  push:
    branches: [ main ]

jobs:
  test:
    runs-on: ubuntu-latest
    
    # SQLite in-memory database is used for testing
    # No external services needed
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      
      - name: Setup PHP
        uses: shivammathur/setup-php@v2
        with:
          php-version: '8.2'
          extensions: mbstring, dom, fileinfo, sqlite3, pdo_sqlite
          coverage: xdebug
      
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'
          cache: 'npm'
      
      - name: Install PHP dependencies
        run: composer install --no-interaction --prefer-dist --optimize-autoloader
      
      - name: Install Node.js dependencies
        run: npm ci
      
      - name: Create environment file
        run: |
          cp .env.ci .env
          php artisan key:generate
      
      - name: Configure database
        run: |
          php artisan config:cache
          php artisan migrate --force
      
      - name: Run PHPUnit tests
        run: php artisan test
      
      - name: Run Laravel Pint (code style check)
        run: vendor/bin/pint --test
      
      - name: Run PHPStan (static analysis)
        run: vendor/bin/phpstan analyse --memory-limit=1G
      
      - name: Build frontend assets
        run: npm run build
      
      - name: Run frontend tests
        run: npm test
      
      - name: Test scraping services
        run: |
          php artisan test --filter=Scraper
          php artisan test --filter=ScrapeCommand
```

## ğŸ¯ ç¾åœ¨ã®å“è³ªçŠ¶æ³
| é …ç›® | çŠ¶æ³ |
|------|------|
| PHPUnitãƒ†ã‚¹ãƒˆ | 223ãƒ†ã‚¹ãƒˆãƒ‘ã‚¹ |
| ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆ | 64ãƒ†ã‚¹ãƒˆãƒ‘ã‚¹ |
| Laravel Pint | ã‚³ãƒ¼ãƒ‰ã‚¹ã‚¿ã‚¤ãƒ«å®Œå…¨ãƒ‘ã‚¹ |
| PHPStan | ãƒ¬ãƒ™ãƒ«4ã§ã‚¨ãƒ©ãƒ¼0 |
| ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ“ãƒ«ãƒ‰ | æœ¬ç•ªãƒ“ãƒ«ãƒ‰æˆåŠŸ |

## ğŸš€ å®Ÿè£…ã•ã‚ŒãŸå“è³ªä¿è¨¼

### è‡ªå‹•å®Ÿè¡Œã•ã‚Œã‚‹æ¤œè¨¼é …ç›®
1. **PHPUnitãƒ†ã‚¹ãƒˆ**: å…¨æ©Ÿèƒ½ã®å‹•ä½œç¢ºèª
2. **Laravel Pint**: PSR-12æº–æ‹ ã®ã‚³ãƒ¼ãƒ‰ã‚¹ã‚¿ã‚¤ãƒ«ãƒã‚§ãƒƒã‚¯
3. **PHPStan**: é™çš„è§£æã«ã‚ˆã‚‹å‹å®‰å…¨æ€§ç¢ºèª
4. **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆ**: Reactã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®å‹•ä½œç¢ºèª
5. **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ“ãƒ«ãƒ‰**: æœ¬ç•ªç’°å¢ƒç”¨ã‚¢ã‚»ãƒƒãƒˆãƒ“ãƒ«ãƒ‰
6. **ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ãƒ†ã‚¹ãƒˆ**: æ—¢å­˜ã®ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ

### æŠ€è¡“çš„ç‰¹å¾´
- **é«˜é€Ÿãƒ†ã‚¹ãƒˆç’°å¢ƒ**: SQLite in-memoryã§å¤–éƒ¨ä¾å­˜ãªã—
- **å®Œå…¨ãªå‹å®‰å…¨æ€§**: PHPStan ãƒ¬ãƒ™ãƒ«4ã§0ã‚¨ãƒ©ãƒ¼
- **æœ€é©åŒ–ã•ã‚ŒãŸãƒ“ãƒ«ãƒ‰é †åº**: Viteã‚¢ã‚»ãƒƒãƒˆç”Ÿæˆ â†’ ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
- **ã‚¯ãƒªãƒ¼ãƒ³ãªãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆ**: 223ã®ä¾¡å€¤ã‚ã‚‹ãƒ†ã‚¹ãƒˆ
- **è­¦å‘Šã‚¼ãƒ­**: PHPUnitã‚¢ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ãƒˆè¨˜æ³•å¯¾å¿œ
- **ç¢ºå®Ÿãªå“è³ªä¿è¨¼**: ã‚¨ãƒ©ãƒ¼éš è”½ãªã—ã®è¨­è¨ˆ

## ç¾åœ¨ã®é–‹ç™ºãƒ•ãƒ­ãƒ¼

### è‡ªå‹•åŒ–ã•ã‚ŒãŸãƒã‚§ãƒƒã‚¯

PRä½œæˆæ™‚ã«è‡ªå‹•å®Ÿè¡Œã•ã‚Œã‚‹é …ç›®ï¼š

```bash
# ä»¥ä¸‹ãŒCI/CDã§è‡ªå‹•å®Ÿè¡Œã•ã‚Œã¾ã™
php artisan test              # PHPUnitãƒ†ã‚¹ãƒˆ
vendor/bin/pint --test       # ã‚³ãƒ¼ãƒ‰ã‚¹ã‚¿ã‚¤ãƒ«ãƒã‚§ãƒƒã‚¯
vendor/bin/phpstan analyse   # é™çš„è§£æ
npm test                     # ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆ
npm run build               # ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ“ãƒ«ãƒ‰
```

### æ‰‹å‹•ãƒã‚§ãƒƒã‚¯ï¼ˆå¿…è¦ã«å¿œã˜ã¦ï¼‰

```bash
# é–‹ç™ºç’°å¢ƒã§ã®è¿½åŠ ãƒã‚§ãƒƒã‚¯
php artisan queue:work --once --queue=scraping
php artisan horizon:status
```

## æœ¬ç•ªç’°å¢ƒ

### Laravel Cloud
- **ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°**: Laravel Cloud
- **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹**: PostgreSQL
- **ãƒ‡ãƒ—ãƒ­ã‚¤æ–¹æ³•**: Gitãƒ™ãƒ¼ã‚¹ã®è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤ã¾ãŸã¯æ‰‹å‹•ãƒ‡ãƒ—ãƒ­ã‚¤

## âœ… å®Ÿè£…å®Œäº†ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—

### ãƒ•ã‚§ãƒ¼ã‚º1: åŸºæœ¬ãƒ†ã‚¹ãƒˆãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³
- âœ… PRä½œæˆæ™‚ã®è‡ªå‹•ãƒ†ã‚¹ãƒˆ
- âœ… ã‚³ãƒ¼ãƒ‰ã‚¹ã‚¿ã‚¤ãƒ«ãƒã‚§ãƒƒã‚¯
- âœ… é™çš„è§£æ
- âœ… ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°é–¢é€£ãƒ†ã‚¹ãƒˆ
- âœ… ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆ

### ãƒ•ã‚§ãƒ¼ã‚º2: ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆè‡ªå‹•åŒ–
- âœ… å“è³ªä¿è¨¼ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³
- âœ… CI/CDå“è³ªå‘ä¸Š
- [ ] è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆï¼ˆä»Šå¾Œæ¤œè¨ï¼‰
- [ ] ãƒ‡ãƒ—ãƒ­ã‚¤å¾Œã®å‹•ä½œç¢ºèª
- [ ] ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æ©Ÿèƒ½

### ãƒ•ã‚§ãƒ¼ã‚º3: ç›£è¦–ã¨ã‚¢ãƒ©ãƒ¼ãƒˆï¼ˆä»Šå¾Œã®æ‹¡å¼µï¼‰
- [ ] ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ç›£è¦–
- [ ] ã‚¨ãƒ©ãƒ¼ã‚¢ãƒ©ãƒ¼ãƒˆ
- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ¡ãƒˆãƒªã‚¯ã‚¹
- [ ] ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°å¤±æ•—æ™‚ã®ã‚¢ãƒ©ãƒ¼ãƒˆ
- [ ] Horizonã‚­ãƒ¥ãƒ¼ã®ç›£è¦–

## é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [é–‹ç™ºãƒ•ãƒ­ãƒ¼](é–‹ç™ºãƒ•ãƒ­ãƒ¼)
- [é–‹ç™ºç’°å¢ƒ](é–‹ç™ºç’°å¢ƒ)
- [æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯](æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯)