# 自動化スクリプト

プロジェクトの開発効率向上のために、様々な自動化スクリプトを提供しています。

## Wiki反映チェック機能

### check-wiki-with-claude.sh

commit後にClaude自身がwiki反映状況をチェック・更新するスクリプトです。

#### 機能概要

- **commit内容分析**: 最新commitの変更内容を自動分析
- **wiki更新判定**: docs/wiki内のドキュメント更新が必要かを自動判定
- **自動更新**: 必要に応じてwikiドキュメントを自動更新
- **CI/CD連携**: 更新されたdocs/wikiは既存のCI/CDでGitHub Wikiに自動反映

#### 判定対象の変更タイプ

| 変更タイプ | 対象ドキュメント |
|------------|------------------|
| 🔧 **技術的変更** | 技術スタック.md、開発環境.md、CI-CD.md |
| 📊 **データベース変更** | データベース設計.md |
| ⚙️ **機能変更** | 機能仕様.md、関連ドキュメント |

#### 自動実行設定

Claude Code hookを使用してgit commit後に自動実行されるよう設定できます。

**設定手順:**

1. `.claude/settings.local.json` に以下のhook設定を追加：

```json
{
  "hooks": {
    "PostToolUse": [
      {
        "matcher": "Bash\\(git commit:.*\\)",
        "hooks": [
          {
            "type": "command",
            "command": "./scripts/check-wiki-with-claude.sh"
          }
        ]
      }
    ]
  }
}
```

2. git commitを実行すると自動的にwiki反映チェックが開始されます

#### 手動実行

```bash
# 基本実行
./scripts/check-wiki-with-claude.sh

# デバッグログ有効化
DEBUG=true ./scripts/check-wiki-with-claude.sh
```

#### 前提条件

- Claude Codeがインストールされていること
- プロジェクトルートディレクトリで実行すること
- docs/wikiディレクトリが存在すること
- Gitリポジトリであること

#### 動作フロー

1. **事前チェック**
   - Claude Codeコマンドの存在確認
   - docs/wikiディレクトリの存在確認
   - Gitリポジトリの確認

2. **commit内容分析**
   - `git log -1 --stat` で変更ファイル確認
   - `git show HEAD --name-only` で変更ファイル一覧取得
   - 変更内容の分類と影響範囲の判定

3. **wiki更新判定・実行**
   - 変更タイプに応じた対応ドキュメントの特定
   - 更新が必要な場合は自動更新を実行
   - 更新不要の場合はスキップ

4. **結果報告**
   - チェック結果の表示
   - 実行したアクションの報告

## トラブルシューティング

### よくある問題と対処法

**Claude Codeコマンドが見つからない**
```bash
# Claude Codeのインストール状況確認
which claude

# パスが通っていない場合、Claude Codeを再インストール
```

**権限エラーが発生する**
```bash
# スクリプトに実行権限を付与
chmod +x scripts/check-wiki-with-claude.sh
```

**hookが動作しない**
- `.claude/settings.local.json`の設定を確認
- JSON形式が正しいかチェック
- Claude Codeの再起動を試行

## 関連ドキュメント

- [開発フロー](開発フロー.md) - 開発フローにおけるスクリプトの位置づけ
- [CI-CD](CI-CD.md) - wiki自動同期のCI/CD設定
- [開発環境](開発環境.md) - Claude Codeの設定方法